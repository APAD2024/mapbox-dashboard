<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>APAD Web Map</title>
    <meta
      name="viewport"
      content="initial-scale=1,maximum-scale=1,user-scalable=no"
    />
    <!-- Link to external CSS file -->

    <link rel="stylesheet" href="src/css/styleguide.css" />
    <link rel="stylesheet" href="src/css/styles.css" />

    <link
      href="https://api.mapbox.com/mapbox-gl-js/v3.2.0/mapbox-gl.css"
      rel="stylesheet"
    />
    <script src="https://api.mapbox.com/mapbox-gl-js/v3.2.0/mapbox-gl.js"></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css"
    />
    <!-- Google Fonts -->
    <link
      href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />

    <script src="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v5.0.1-dev/mapbox-gl-geocoder.min.js"></script>
    <link
      rel="stylesheet"
      href="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v5.0.1-dev/mapbox-gl-geocoder.css"
      type="text/css"
    />

    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1"></script>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://unpkg.com/@turf/turf@6/turf.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@turf/turf@6.5.0/turf.min.js"></script>
  </head>

  <body>
    <div class="dashboard">
      <!--------------------------- TOP BAR --------------------------->
      <div id="topContainer">
        <div id="topBar">
          <!-- Left Section: Logo and Title -->
          <div class="left-section">
            <button id="menuButton" class="menu-btn" aria-label="Open menu">
              <img src="src/assets/menu-button.svg" alt="" class="icon" />
            </button>
            <img src="src/assets/logo.svg" alt="Logo" class="logo" />

            <!-- Dropdown Menu -->
            <ul id="menuList" class="menu-list hidden">
              <li>
                <a href="https://apad.world/" target="_blank" rel="noopener"
                  >More Information</a
                >
              </li>
              <li>
                <a
                  href="https://survey123.arcgis.com/share/491dccba7ed14379ab459551f96722ff"
                  target="_blank"
                  rel="noopener"
                  >Survey Form</a
                >
              </li>
            </ul>
          </div>

          <!-- Right Section: Geocoder Search Bar + Filters -->
          <div class="right-section">
            <div class="geocoder-section">
              <!-- Geocoder Search Box Start -->
              <div id="geocoder"></div>
              <!-- Geocoder Search Box End -->
            </div>

            <!-- Right Section: Filters for Country and Asset -->
            <div class="filter-section">
              <div class="filter-container">
                <label for="polutantType" class="filter-label"
                  >Pollutant Type</label
                >
                <select id="polutantType" class="filter-select">
                  <option value="">All</option>
                  <option value="pm10">PM‚ÇÇ.‚ÇÖ</option>
                  <option value="pm25">PM‚ÇÅ‚ÇÄ</option>
                  <option value="so2">SO‚ÇÇ</option>
                  <option value="nox">NO‚ÇÇ</option>
                </select>
              </div>

              <div class="filter-container">
                <label for="countryFilter" class="filter-label">Country</label>
                <select id="countryFilter" class="filter-select">
                  <option value="">All</option>
                </select>
              </div>

              <div class="filter-container">
                <label for="assetFilter" class="filter-label">Asset Type</label>
                <select id="assetFilter" class="filter-select">
                  <option value="">All</option>
                </select>
              </div>
            </div>
          </div>
        </div>

        <div class="tooltipContainer">
          <div class="tooltip" id="tooltipAQ">Air Quality Data activated</div>

          <div class="tooltip" id="tooltipPollutionReports">
            Report Pollution activated
          </div>

          <div class="tooltip" id="tooltipPM2.5">Population Weighted PM2.5 Exposure activated</div>
          <div class="tooltip" id="tooltipWHO2023">Potential Gain in Life Expectancy (Compared to WHO guideline)</div>
          <div class="tooltip" id="tooltipAggregate">
            Click on the map to aggregate data within the selected buffer size.
          </div>
        </div>
      </div>

      <!--------------------------- FLOATING BUTTONS TOP RIGHT  --------------------------->

      <!-- Basemap Menu -->
      <div class="FAB" id="basemapMenuButton"><i class="fas fa-globe"></i></div>
      <div id="menu">
        <button class="closeButton">&times;</button>

        <input
          id="satellite-streets-v12"
          type="radio"
          name="rtoggle"
          value="satellite-streets-v12"
        />
        <label for="satellite-streets-v12">Satellite</label><br />

        <input id="light-v11" type="radio" name="rtoggle" value="light-v11" />
        <label for="light-v11">Light</label><br />

        <input
          id="dark-v11"
          type="radio"
          name="rtoggle"
          value="dark-v11"
          checked="checked"
        />
        <label for="dark-v11">Dark</label><br />

        <input
          id="google-air-quality"
          type="radio"
          name="rtoggle"
          value="google-air-quality"
        />
        <label for="google-air-quality">Google Air Quality</label><br />
      </div>

      <!-- Continent Switch Button -->
      <div class="FAB" id="areaChange" title="Move to Africa">
        <i class="fas fa-globe-africa"></i>
      </div>

      

      <!--------------------------- FLOATING BUTTONS BOTTOM LEFT --------------------------->

      <!-- Air Quality Button -->

      <div class="FAB" id="buttonOpenAQData" title="Air Quality Layer">
        <img src="src/assets/openaq_dark_logo.png" alt="Air quality icon" style="width: 40px; height: 40px;" />
      </div>

      <!-- PM2.5/WHO 2023 Dropdown Button -->
      <div class="fab-dropdown-container FAB" id="dropdown">
        <div class="FAB" id="pm25MainButton" title="Air Quality Layers">
          <svg class="epic-logo" width="80" height="80" viewBox="0 0 280 93" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
            <defs>
              <path id="prefix__a" d="M0 0h5.482v4.703H0z"></path>
              <path id="prefix__c" d="M0 0h5.082v4.703H0z"></path>
              <path id="prefix__e" d="M0 0h5.081v4.703H0z"></path>
            </defs>
            <g fill="none" fill-rule="evenodd"><path fill="#8F3931" d="M77.06 62.638a1.615 1.615 0 1 0-.561-3.181 1.615 1.615 0 0 0 .56 3.181M73.3 63.661a1.456 1.456 0 0 0-.506-2.865 1.455 1.455 0 0 0 .505 2.865m-3.758.488a1.31 1.31 0 1 0-.455-2.579 1.31 1.31 0 0 0 .455 2.579"></path><path fill="#6D3227" d="M66.937 63.345a1.177 1.177 0 1 0-2.212-.806 1.177 1.177 0 0 0 2.212.806M60.178 61.5a.956.956 0 0 0-1.794-.653.954.954 0 1 0 1.794.652"></path><path fill="#C68220" d="M51.127 46.842a.778.778 0 1 0-1.463-.532.778.778 0 0 0 1.463.532"></path><path fill="#8F3931" d="M79.816 56.745a1.617 1.617 0 1 0-1.213-2.998 1.617 1.617 0 0 0 1.213 2.998m-3.466 1.782a1.454 1.454 0 1 0-1.087-2.696 1.454 1.454 0 0 0 1.088 2.696m-3.574 1.258a1.308 1.308 0 1 0-.98-2.427 1.308 1.308 0 0 0 .98 2.427m-2.715-.245a1.178 1.178 0 1 0-2.332-.328 1.178 1.178 0 0 0 2.332.328"></path><path fill="#6D3227" d="M63.067 59.14a.954.954 0 1 0-1.89-.265.954.954 0 0 0 1.89.265M52.84 51.564a.748.748 0 1 0-1.481-.209.748.748 0 0 0 1.48.209"></path><path fill="#9A5324" d="M81.287 50.406a1.616 1.616 0 1 0-1.806-2.679 1.616 1.616 0 0 0 1.806 2.68"></path><path fill="#8F3931" d="M78.269 52.87a1.454 1.454 0 1 0-1.627-2.41 1.454 1.454 0 0 0 1.627 2.41m-3.235 1.974a1.309 1.309 0 1 0-1.464-2.17 1.309 1.309 0 0 0 1.464 2.17m-6.129 1.216a1.06 1.06 0 1 0-2.114.148 1.06 1.06 0 0 0 2.114-.148m-3.503.172a.954.954 0 1 0-1.903.132.954.954 0 0 0 1.903-.132"></path><path fill="#6D3227" d="M61.875 55.655a.86.86 0 1 0-1.716.123.86.86 0 0 0 1.716-.123m-3.285-1.244a.773.773 0 1 0-1.541.109.773.773 0 0 0 1.542-.109"></path><path fill="#9A5324" d="M81.41 43.9a1.617 1.617 0 1 0-2.328-2.244 1.617 1.617 0 0 0 2.327 2.245m-2.44 3.037a1.455 1.455 0 1 0-2.095-2.02 1.455 1.455 0 0 0 2.095 2.02"></path><path fill="#8F3931" d="M76.215 49.541a1.308 1.308 0 1 0-1.881-1.818 1.308 1.308 0 0 0 1.88 1.818m-2.578.881a1.178 1.178 0 1 0-2.265.65 1.178 1.178 0 0 0 2.265-.65m-3.163 1.584a1.061 1.061 0 1 0-2.04.586 1.061 1.061 0 0 0 2.04-.586m-6.961 1.065a.858.858 0 1 0-1.65.473.858.858 0 0 0 1.65-.473"></path><path fill="#C16622" d="M80.175 37.512a1.616 1.616 0 1 0-2.741-1.712 1.616 1.616 0 0 0 2.741 1.712M78.42 40.99a1.454 1.454 0 1 0-2.467-1.54 1.454 1.454 0 0 0 2.467 1.54m-2.152 3.12a1.309 1.309 0 1 0-2.22-1.387 1.309 1.309 0 0 0 2.22 1.386"></path><path fill="#9A5324" d="M73.927 45.507a1.178 1.178 0 1 0-2.08 1.105 1.178 1.178 0 0 0 2.08-1.105m-2.765 2.207a1.06 1.06 0 1 0-1.871.995 1.06 1.06 0 0 0 1.871-.995m-3.129 1.581a.953.953 0 1 0-1.684.894.953.953 0 0 0 1.684-.894m-3.457.908a.859.859 0 1 0-1.516.807.859.859 0 0 0 1.516-.807m-3.506.2a.773.773 0 1 0-1.365.725.773.773 0 0 0 1.365-.725"></path><path fill="#C16622" d="M77.64 31.52a1.616 1.616 0 1 0-3.038-1.105 1.616 1.616 0 0 0 3.039 1.104m-.995 3.768a1.454 1.454 0 1 0-2.731-.996 1.454 1.454 0 0 0 2.731.996m-1.456 3.498a1.309 1.309 0 1 0-2.46-.895 1.309 1.309 0 0 0 2.46.895m-1.999 1.854a1.178 1.178 0 1 0-1.805 1.514 1.178 1.178 0 0 0 1.805-1.514"></path><path fill="#9A5324" d="M70.945 43.372a1.06 1.06 0 1 0-1.625 1.364 1.06 1.06 0 0 0 1.625-1.364m-2.732 2.198a.955.955 0 1 0-1.462 1.228.955.955 0 0 0 1.462-1.228m-12.475 2.525a.746.746 0 1 0-1.145.96.748.748 0 0 0 1.145-.96"></path><path fill="#C16622" d="M73.915 26.185a1.616 1.616 0 1 0-3.2-.45 1.616 1.616 0 0 0 3.2.45m-.189 3.892a1.454 1.454 0 1 0-2.88-.405 1.454 1.454 0 0 0 2.88.405M71.46 36.03a1.178 1.178 0 1 0-1.45 1.858 1.178 1.178 0 0 0 1.45-1.858"></path><path fill="#9A5324" d="M67.615 41.888a.954.954 0 1 0-1.175 1.503.954.954 0 0 0 1.175-1.503m-2.789 2.236a.86.86 0 1 0-1.058 1.354.86.86 0 0 0 1.058-1.354m-3.122 1.608a.772.772 0 1 0-.952 1.216.772.772 0 0 0 .952-1.216"></path><path fill="#C16622" d="M69.162 21.742a1.616 1.616 0 1 0-3.224.225 1.616 1.616 0 0 0 3.224-.225m.624 3.846a1.454 1.454 0 1 0-2.902.202 1.454 1.454 0 0 0 2.902-.202m.092 3.788a1.31 1.31 0 1 0-2.613.184 1.31 1.31 0 0 0 2.613-.184m-1.072 2.506a1.179 1.179 0 1 0-1.032 2.12 1.179 1.179 0 0 0 1.032-2.12m-.94 3.41a1.06 1.06 0 1 0-.93 1.905 1.06 1.06 0 0 0 .93-1.905m-1.602 3.119a.954.954 0 1 0-.837 1.715.954.954 0 0 0 .837-1.715"></path><path fill="#9A5324" d="M64 41.178a.86.86 0 1 0-.753 1.545.86.86 0 0 0 .754-1.545m-2.72 2.222a.773.773 0 1 0-.678 1.39.773.773 0 0 0 .678-1.39m-5.386 2.389a.749.749 0 1 0-.655 1.347.749.749 0 0 0 .655-1.347"></path><path fill="#F8A429" d="M63.588 18.384a1.616 1.616 0 1 0-3.107.892 1.616 1.616 0 0 0 3.107-.892"></path><path fill="#C16622" d="M65.876 25.702a1.309 1.309 0 1 0-2.516.72 1.309 1.309 0 0 0 2.516-.72m-.737 6.205a1.06 1.06 0 1 0 .772 1.285 1.06 1.06 0 0 0-.772-1.285m-.919 3.384a.954.954 0 1 0-.462 1.85.954.954 0 0 0 .462-1.85m-1.639 3.177a.86.86 0 1 0-.414 1.668.86.86 0 0 0 .414-1.668"></path><path fill="#9A5324" d="M60.384 41.207a.773.773 0 1 0-.374 1.5.773.773 0 0 0 .374-1.5"></path><g transform="translate(54 14.604)"><mask id="prefix__b" fill="#fff"><use xlink:href="#prefix__a"></use></mask><path fill="#F8A429" d="M3.438 1.653A1.615 1.615 0 1 0 .585 3.17a1.615 1.615 0 1 0 2.853-1.517" mask="url(#prefix__b)"></path></g><path fill="#F8A429" d="M59.573 19.517a1.454 1.454 0 1 0-2.568 1.367 1.454 1.454 0 0 0 2.568-1.367m1.625 3.423a1.308 1.308 0 1 0-2.31 1.229 1.308 1.308 0 0 0 2.31-1.229"></path><path fill="#C68220" d="M61.239 25.666a1.178 1.178 0 1 0-.083 2.354 1.178 1.178 0 0 0 .083-2.354m.528 3.497a1.06 1.06 0 1 0-.073 2.12 1.06 1.06 0 0 0 .073-2.12m-1.137 6.95a.858.858 0 1 0-.062 1.714.858.858 0 0 0 .062-1.714m-1.58 3.136a.773.773 0 1 0-.054 1.545.773.773 0 0 0 .053-1.545"></path><path fill="#F8A429" d="M53.747 18.202a1.455 1.455 0 1 0-2.228 1.87 1.455 1.455 0 0 0 2.228-1.87m2.301 3.01a1.31 1.31 0 1 0-2.004 1.682 1.31 1.31 0 0 0 2.004-1.682m.607 2.658a1.177 1.177 0 1 0 .408 2.318 1.177 1.177 0 0 0-.408-2.319"></path><path fill="#C68220" d="M57.898 27.18a1.06 1.06 0 1 0 .368 2.088 1.06 1.06 0 0 0-.368-2.087m.538 3.465a.954.954 0 1 0 .331 1.88.954.954 0 0 0-.331-1.88m-.206 3.568a.859.859 0 1 0 .3 1.691.859.859 0 0 0-.3-1.69m-.893 3.395a.773.773 0 1 0 .269 1.523.773.773 0 0 0-.27-1.522"></path><path fill="#F8A429" d="M47.775 18.126a1.455 1.455 0 1 0-1.791 2.292 1.455 1.455 0 0 0 1.791-2.292m5.927 7.919a1.06 1.06 0 1 0 .793 1.965 1.06 1.06 0 0 0-.793-1.965"></path><path fill="#C68220" d="M54.948 29.323a.954.954 0 1 0 .716 1.77.954.954 0 0 0-.716-1.77m.542 3.533a.86.86 0 1 0 .644 1.594.86.86 0 0 0-.644-1.594m-.168 3.508a.773.773 0 1 0 .579 1.434.773.773 0 0 0-.58-1.434m-1.83 5.596a.748.748 0 1 0 .56 1.387.748.748 0 0 0-.56-1.387"></path><path fill="#91AB5A" d="M32.579 21.058a1.615 1.615 0 1 0-.782 3.135 1.615 1.615 0 0 0 .782-3.135"></path><path fill="#C68220" d="M51.348 41.1a.747.747 0 1 0 1.073 1.038.747.747 0 0 0-1.073-1.039"></path><path fill="#91AB5A" d="M27.663 25.321a1.616 1.616 0 1 0-.113 3.23 1.616 1.616 0 0 0 .113-3.23"></path><path fill="#656D33" d="M43.939 29.945a.954.954 0 1 0 1.617 1.012.954.954 0 0 0-1.617-1.012m3.49 8.673a.74.74 0 1 0 1.417.434.74.74 0 0 0-1.417-.434m-4.752 4.407a.74.74 0 1 0 1.307-.694.74.74 0 0 0-1.307.694"></path><path fill="#155F83" d="M41.942 47.346a.74.74 0 1 0 .785-1.255.74.74 0 0 0-.785 1.255m.492 2.155a.74.74 0 1 0 .431-1.416.74.74 0 0 0-.431 1.416m1.032 1.955a.74.74 0 1 0 .051-1.48.74.74 0 0 0-.051 1.48"></path><path fill="#5B96AD" d="M46.84 54.253a.741.741 0 1 0-.697-1.308.741.741 0 0 0 .697 1.308"></path><path fill="#6D3227" d="M51.16 54.988a.74.74 0 1 0-1.255-.784.74.74 0 0 0 1.256.784"></path><path fill="#9A5324" d="M58.72 47.978a.74.74 0 1 0-1.084 1.01.74.74 0 0 0 1.084-1.01m.083-2.209a.74.74 0 1 0-.785 1.255.74.74 0 0 0 .785-1.255m-.491-2.155a.74.74 0 1 0-.433 1.417.74.74 0 0 0 .433-1.417"></path><path fill="#C68220" d="M57.279 41.66a.74.74 0 1 0-.052 1.48.74.74 0 0 0 .052-1.48m-1.503-1.621a.74.74 0 1 0 .333 1.443.74.74 0 1 0-.333-1.443m-1.871-1.177a.742.742 0 0 0 .695 1.308.741.741 0 0 0-.695-1.308"></path><path fill="#91AB5A" d="M23.741 30.513a1.616 1.616 0 1 0 .56 3.182 1.616 1.616 0 0 0-.56-3.182"></path><path fill="#656D33" d="M46.105 36.085a.772.772 0 1 0 1.45.53.772.772 0 0 0-1.45-.53m2.933 5.099a.747.747 0 1 0 1.404.512.747.747 0 0 0-1.404-.512"></path><path fill="#91AB5A" d="M20.984 36.406a1.615 1.615 0 1 0 1.21 2.996 1.615 1.615 0 0 0-1.21-2.996m7.039-3.04a1.309 1.309 0 1 0 .98 2.427 1.309 1.309 0 0 0-.98-2.427m6.249.084a1.059 1.059 0 1 0 2.099.296 1.06 1.06 0 1 0-2.1-.295"></path><g transform="translate(18.8 41.804)"><mask id="prefix__d" fill="#fff"><use xlink:href="#prefix__c"></use></mask><path fill="#155F83" d="M.712.94A1.616 1.616 0 1 0 2.52 3.62 1.616 1.616 0 0 0 .712.94" mask="url(#prefix__d)"></path></g><path fill="#91AB5A" d="M22.531 40.28a1.454 1.454 0 1 0 1.627 2.412 1.454 1.454 0 0 0-1.627-2.411"></path><path fill="#656D33" d="M46.963 42.202a.747.747 0 1 0 1.491-.104.747.747 0 0 0-1.49.104"></path><path fill="#155F83" d="M19.39 49.25a1.617 1.617 0 1 0 2.328 2.245 1.617 1.617 0 0 0-2.327-2.245m2.44-3.037a1.454 1.454 0 1 0 2.093 2.02 1.454 1.454 0 0 0-2.093-2.02"></path><path fill="#91AB5A" d="M24.585 43.61a1.309 1.309 0 1 0 1.883 1.818 1.309 1.309 0 0 0-1.883-1.818m5.742-2.465a1.061 1.061 0 1 0 2.04-.586 1.061 1.061 0 0 0-2.04.586m6.961-1.065a.858.858 0 1 0 1.65-.473.858.858 0 0 0-1.65.473"></path><path fill="#656D33" d="M40.76 40.614a.773.773 0 1 0 1.485-.426.773.773 0 0 0-1.486.426"></path><path fill="#5B96AD" d="M20.625 55.639a1.615 1.615 0 1 0 2.742 1.714 1.615 1.615 0 0 0-2.742-1.714m1.755-3.479a1.455 1.455 0 1 0 2.468 1.542 1.455 1.455 0 0 0-2.468-1.542"></path><path fill="#155F83" d="M26.873 47.644a1.178 1.178 0 1 0 2.08-1.105 1.178 1.178 0 0 0-2.08 1.105m2.764-2.207a1.06 1.06 0 1 0 1.872-.995 1.06 1.06 0 0 0-1.872.995m3.13-1.581a.953.953 0 1 0 1.684-.894.953.953 0 0 0-1.684.894"></path><path fill="#656D33" d="M45.481 43.975a.748.748 0 1 0 1.32-.702.748.748 0 0 0-1.32.702"></path><path fill="#5B96AD" d="M23.16 61.631a1.616 1.616 0 1 0 3.037 1.105 1.616 1.616 0 0 0-3.038-1.105m2.451-7.265a1.309 1.309 0 1 0 2.46.895 1.309 1.309 0 0 0-2.46-.895m1.999-1.854A1.177 1.177 0 1 0 29.412 51a1.177 1.177 0 0 0-1.803 1.513"></path><path fill="#155F83" d="M29.855 49.779a1.06 1.06 0 1 0 1.625-1.364 1.06 1.06 0 0 0-1.625 1.364m5.925-3.805a.86.86 0 1 0 1.316-1.106.86.86 0 0 0-1.316 1.106m3.388-.924a.773.773 0 1 0 1.184-.993.773.773 0 0 0-1.184.993"></path><path fill="#5B96AD" d="M26.885 66.966a1.615 1.615 0 1 0 3.2.45 1.615 1.615 0 0 0-3.2-.45m.189-3.892a1.454 1.454 0 1 0 2.88.405 1.454 1.454 0 0 0-2.88-.405m.698-3.724a1.309 1.309 0 1 0 2.592.364 1.309 1.309 0 0 0-2.592-.364m1.568-2.23a1.178 1.178 0 1 0 1.451-1.855 1.178 1.178 0 0 0-1.45 1.856m1.629-3.141a1.06 1.06 0 1 0 1.304-1.671 1.06 1.06 0 0 0-1.304 1.672"></path><path fill="#155F83" d="M33.185 51.263a.954.954 0 1 0-.165-1.34.954.954 0 0 0 .165 1.34m2.789-2.236a.86.86 0 1 0 1.058-1.354.86.86 0 0 0-1.058 1.354m3.122-1.608a.773.773 0 1 0 .951-1.218.773.773 0 0 0-.95 1.218m5.753-1.221a.748.748 0 1 0 .92-1.178.748.748 0 0 0-.92 1.178"></path><path fill="#5B96AD" d="M31.994 61.269a1.179 1.179 0 1 0 1.032-2.12 1.179 1.179 0 0 0-1.032 2.12m2.542-6.529a.954.954 0 1 0 .837-1.716.954.954 0 0 0-.837 1.716"></path><path fill="#155F83" d="M36.8 51.973a.86.86 0 1 0 .753-1.544.86.86 0 0 0-.754 1.544m2.72-2.223a.773.773 0 1 0 .677-1.389.773.773 0 0 0-.677 1.39"></path><path fill="#5B96AD" d="M36.58 57.86a.954.954 0 1 0 .462-1.85.954.954 0 0 0-.462 1.85m1.639-3.177a.859.859 0 1 0 .415-1.667.859.859 0 0 0-.415 1.667"></path><path fill="#155F83" d="M40.416 51.944a.773.773 0 1 0 .374-1.5.773.773 0 0 0-.374 1.5"></path><path fill="#5B96AD" d="M39.033 63.987a1.06 1.06 0 1 0 .074-2.119 1.06 1.06 0 0 0-.074 2.12"></path><path fill="#155F83" d="M41.75 53.902a.773.773 0 1 0 .054-1.545.773.773 0 0 0-.053 1.545"></path><path fill="#5B96AD" d="M42.57 58.936a.858.858 0 1 0-.299-1.69.859.859 0 1 0 .299 1.69m.893-3.396a.773.773 0 1 0-.269-1.522.773.773 0 0 0 .27 1.522"></path><path fill="#155F83" d="M46.404 50.442a.747.747 0 1 0-.259-1.471.747.747 0 0 0 .259 1.471"></path><g transform="translate(61.2 71.404)"><mask id="prefix__f" fill="#fff"><use xlink:href="#prefix__e"></use></mask><path fill="#6D3227" d="M1.326 3.836A1.616 1.616 0 1 0 2.743.932a1.616 1.616 0 0 0-1.417 2.904" mask="url(#prefix__f)"></path></g><path fill="#5B96AD" d="M48.274 61.053a.859.859 0 1 0-.96-1.423.859.859 0 0 0 .96 1.423"></path><path fill="#155F83" d="M48.323 51.73a.748.748 0 1 0-.837-1.239.748.748 0 0 0 .837 1.24"></path><path fill="#8F3931" d="M68.221 72.093a1.615 1.615 0 1 0 .782-3.135 1.615 1.615 0 0 0-.782 3.135"></path><path fill="#6D3227" d="M64.37 71.498a1.454 1.454 0 1 0 .704-2.821 1.454 1.454 0 0 0-.704 2.821"></path><path fill="#8F3931" d="M73.137 67.83a1.616 1.616 0 1 0 .113-3.23 1.616 1.616 0 0 0-.113 3.23m-3.891.219a1.455 1.455 0 1 0 .102-2.908 1.455 1.455 0 0 0-.102 2.908"></path><path fill="#6D3227" d="M54.346 60.666a.86.86 0 1 0-1.457-.91.86.86 0 0 0 1.457.91M52.42 57.73a.773.773 0 1 0-1.065.246.773.773 0 0 0 1.065-.247m-1.82-5.602a.748.748 0 1 0-1.271-.792.748.748 0 0 0 1.27.792"></path><path fill="#C68220" d="M50.35 43.587a.678.678 0 0 0 .974.94.677.677 0 0 0-.973-.94"></path><path fill="#656D33" d="M48.028 44.744a.677.677 0 1 0 1.342-.175.677.677 0 0 0-1.342.175"></path><path fill="#155F83" d="M49.131 49.289a.676.676 0 1 0-.468-1.269.676.676 0 0 0 .468 1.269"></path><path fill="#6D3227" d="M51.727 49.253a.677.677 0 1 0-1.287-.423.677.677 0 0 0 1.287.423"></path><path fill="#9A5324" d="M53.316 47.202a.677.677 0 1 0-1.133.742.677.677 0 0 0 1.133-.742"></path><path fill="#1C2B39" d="m100.345 53.62-2.016 6.98H90.11l11.837-35.15h9.46l11.734 35.15h-8.374l-2.068-6.979zm10.338-6.41-2.894-9.924c-.62-2.223-1.19-4.55-1.19-4.55h-.051s-.62 2.327-1.292 4.601l-2.998 9.874zm14.63-4.187c0-10.803 6.616-18.195 17.006-18.195s17.006 7.392 17.006 18.195c0 3.619-.672 6.824-2.016 9.512l4.342 4.032-5.737 5.53-3.567-3.721c-2.688 1.81-6.048 2.843-10.028 2.843-10.7 0-17.007-7.444-17.007-18.196zm7.805 0c0 7.34 3.204 11.631 9.2 11.631 5.945 0 9.202-4.29 9.202-11.63s-3.36-11.786-9.201-11.786c-5.893 0-9.201 4.445-9.201 11.785m32.669-17.575h7.805v28.12h14.06v7.03h-21.865zm34.323 0v35.15h-7.805v-35.15z"></path><path fill="#748390" d="M213.49 39.06 212.47 42h-1.38l3.645-10.2h1.47L219.79 42h-1.425l-1.02-2.94zm3.48-1.14-1.155-3.36c-.195-.525-.33-.945-.39-1.2h-.015c-.075.255-.195.66-.39 1.215l-1.14 3.345zm5.175-3.06V42H220.9v-7.14zm0-3.06v1.59H220.9V31.8zm5.79 2.925v1.185c-.15-.03-.33-.045-.465-.045-1.35 0-2.1 1.2-2.1 2.4V42h-1.245v-7.14h1.245v1.35c.165-.825 1.17-1.53 2.16-1.53.135 0 .3.015.405.045m3.945 2.175c0-3.105 1.785-5.28 4.635-5.28 2.835 0 4.62 2.175 4.62 5.28 0 1.395-.345 2.595-.99 3.495l1.065 1.095-.96.93-1.02-1.08c-.735.54-1.65.84-2.715.84-2.85 0-4.635-2.175-4.635-5.28m1.38 0c0 2.49 1.23 4.11 3.255 4.11 2.01 0 3.24-1.62 3.24-4.11s-1.215-4.11-3.24-4.11-3.255 1.605-3.255 4.11m9.51 2.025V34.86h1.245v4.11c0 .675.075 1.125.24 1.44.255.495.705.675 1.38.675 1.2 0 1.815-.975 1.815-2.13V34.86h1.245V42h-1.245v-1.05c-.39.69-1.08 1.23-2.28 1.23-.735 0-1.365-.21-1.785-.675-.45-.51-.615-1.02-.615-2.58m14.055 2.31v.87a3.7 3.7 0 0 1-.705.06c-.87 0-1.155-.375-1.2-.96h-.015c-.225.375-.855.99-2.205.99-1.455 0-2.43-.78-2.43-2.16 0-.81.36-1.335.915-1.665s1.32-.48 2.085-.615l.975-.165c.45-.075.6-.135.6-.435v-.15c0-.75-.24-1.29-1.515-1.29-1.29 0-1.68.66-1.68 1.515l-1.2-.135c-.03-1.605 1.335-2.385 2.94-2.385 1.59 0 2.655.465 2.655 2.25v3.63c0 .495.18.645.615.645zm-1.98-1.56V38.37c-.105.045-.3.105-.825.21l-.69.15c-.555.12-1.065.225-1.395.465-.24.165-.375.42-.375.78 0 .81.63 1.245 1.515 1.245.9 0 1.77-.435 1.77-1.545m4.62-7.875V42h-1.245V31.8zm3.3 3.06V42h-1.245v-7.14zm0-3.06v1.59h-1.245V31.8zm1.17 4.005v-.945h1.38v-2.58l1.245-.27v2.85h1.575v.945h-1.575v4.425c0 .315.015.525.105.675.09.165.255.24.645.24.3 0 .585-.045.825-.09v.975c-.36.09-.78.15-1.245.15-.675 0-1.26-.15-1.485-.75-.06-.165-.09-.39-.09-.69v-4.935zm11.04-.945-3.135 8.595c-.45 1.245-1.14 1.515-2.16 1.515-.375 0-.66-.045-.9-.09v-1.005c.3.045.555.075.81.075.36 0 .66-.045.9-.285.15-.15.27-.36.39-.72l.315-.915-2.475-7.17h1.32l1.395 4.32c.195.6.39 1.245.39 1.245h.015s.21-.705.435-1.335l1.455-4.23zM218.56 58.815V60h-6.375V49.8h1.335v9.015zm2.4-5.955V60h-1.245v-7.14zm0-3.06v1.59h-1.245V49.8zm5.475 3.06v.945h-1.515V60h-1.245v-6.195h-1.455v-.945h1.455v-1.44c0-1.14.54-1.725 1.815-1.725.465 0 .795.06.945.09v1.005a5 5 0 0 0-.585-.045c-.42 0-.645.075-.78.27-.12.18-.15.39-.15.735v1.11zm6.51 5.025.9.645c-.27.42-1.2 1.65-3.15 1.65-2.04 0-3.405-1.395-3.405-3.78 0-2.19 1.425-3.705 3.39-3.705 2.145 0 3.21 1.62 3.21 3.75v.27h-5.34c.03 1.17.69 2.385 2.265 2.385 1.245 0 1.875-.795 2.13-1.215M230.68 53.7c-1.095 0-1.95.78-2.085 2.025h4.005c-.105-1.26-.795-2.025-1.92-2.025m9.27-3.9V60h-1.32V49.8zm8.175 5.73V60h-1.245v-4.155c0-1.545-.57-2.055-1.62-2.055-1.2 0-1.89.96-1.89 2.085V60h-1.245v-7.14h1.245v1.065c.375-.66 1.11-1.23 2.295-1.23.93 0 1.62.315 2.01.915.3.465.45 1.08.45 1.92m4.605 4.65c-1.815 0-3.105-1.395-3.105-3.735 0-2.4 1.365-3.75 3.15-3.75 1.29 0 2.04.72 2.295 1.215V49.8h1.245V60h-1.245v-1.05c-.255.48-.99 1.23-2.34 1.23m2.46-3.765c0-1.8-.96-2.7-2.19-2.7-1.26 0-2.1.96-2.1 2.7 0 1.71.78 2.715 2.07 2.715 1.245 0 2.22-.9 2.22-2.715m8.355 1.47.9.645c-.27.42-1.2 1.65-3.15 1.65-2.04 0-3.405-1.395-3.405-3.78 0-2.19 1.425-3.705 3.39-3.705 2.145 0 3.21 1.62 3.21 3.75v.27h-5.34c.03 1.17.69 2.385 2.265 2.385 1.245 0 1.875-.795 2.13-1.215M261.28 53.7c-1.095 0-1.95.78-2.085 2.025h4.005c-.105-1.26-.795-2.025-1.92-2.025m7.845 2.52L271.57 60h-1.5l-1.71-2.865-1.8 2.865h-1.365l2.49-3.705-2.295-3.435h1.515l1.56 2.505 1.575-2.505h1.38z"></path><text fill="#748390" font-family="Theinhardt-Medium, Theinhardt" font-size="10" font-weight="400" letter-spacing=".909"><tspan x="273" y="56">¬Æ</tspan></text></g>
          </svg>
        </div>
        
        <div class="fab-dropdown-menu hidden" id="pm25DropdownMenu">
          <div class="fab-menu-item" id="buttonPM25Data" title="PM2.5 Population Weighted Exposure">
            PM25 Exposure
          </div>
          <div class="fab-menu-item" id="buttonWHO25Data" title="WHO 2023 Life Expectancy">
            Potential Gain in Life Expectancy (WHO)
          </div>
        </div>
      </div>

     

      <!--Aggregate Tool -->

      <div id="aggregateToolContainer">
        <div class="FAB" id="aggregateToolButton" title="Aggregate Data">
          <i class="fas fa-calculator"></i>
        </div>

        <select
          id="bufferSizeSelector"
          title="Select Buffer Size"
          class="bufferSizeSelector-hidden"
        >
          <option value="5">5 km</option>
          <option value="10">10 km</option>
          <option value="20">20 km</option>
          <option value="100" selected>100 km</option>
        </select>
      </div>

       <!-- Report Poluttion Button -->
      <div
        class="FAB"
        id="buttonPollutionReports"
        title="Button Report Polution Layer"
      >
        <i class="fa-solid fa-star-of-life" alt="Report"></i>
      </div>

      <div id="aggregateResults"></div>

      <!--------------------------- MAP --------------------------->

      <div id="map"></div>

      <!-- Loading spinner (add this inside the <body> of your HTML) -->
      <div id="loadingSpinner" class="loading-spinner" style="display: none">
        <div class="spinner"></div>
      </div>

      <!---------------------------LEGEND LAYERS --------------------------->

      <div class="legend-container">
        <div class="FAB" id="legendButton">Layers</div>

        <div id="legend">
          <button class="closeButton">&times;</button>

          <div class="legend-group">
            <div class="legend-group-title">
              Extraction or primary energy generation
            </div>
            <!-- Group 1: Extraction or primary energy generation -->

            <!-- Coal -->
            <div class="legend-section" id="legend-coal" draggable="true">
              <label class="custom-checkbox">
                <input id="toggleCoal" type="checkbox" checked />
                <span class="checkmark"></span>
              </label>
              <div class="legend-name">
                <div
                  class="legend-key"
                  style="
                    width: 2rem;
                    height: 2rem;
                    background-color: hsla(162, 50%, 45%, 0.5);
                    border: 0.1rem solid hsla(162, 50%, 45%, 1);
                  "
                ></div>
                <p>Coal</p>
              </div>
            </div>

            <!-- Fossil Fuel -->
            <!-- <div
              class="legend-section"
              id="legend-fossil-fuel"
              draggable="true"
            >
              <label class="custom-checkbox">
                <input id="toggleFossilFuel" type="checkbox" checked />
                <span class="checkmark"></span>
              </label>
              <div class="legend-name">
                <div
                  class="legend-key"
                  style="
                    width: 2rem;
                    height: 2rem;
                    background-color: hsla(205, 50%, 50%, 0.5);
                    border: 0.1rem solid hsla(205, 50%, 50%, 1);
                  "
                ></div>
                <p>Fossil Fuel</p>
              </div>
            </div> -->

            <!-- Furnace Oil -->
            <div
              class="legend-section"
              id="legend-furnace-oil"
              draggable="true"
            >
              <div style="display: flex; align-items: center; width: 100%; position: relative;">
                <div class="legend-name" style="flex: 1;">
                  <div
                    class="legend-key"
                    style="
                      width: 2rem;
                      height: 2rem;
                      background-color: hsla(324, 50%, 50%, 0.5);
                      border: 0.1rem solid hsla(324, 50%, 50%, 1);
                    "
                  ></div>
                  <p>Power Generation Plant</p>
                </div>
                <button 
                  id="furnaceOilToggleBtn" 
                  style="background: none; border: none; cursor: pointer; padding: 0.5rem; font-size: 1rem; color: inherit;"
                  aria-label="Toggle furnace oil subdivisions"
                >
                  ‚ñ∂
                </button>

              </div>
            </div>
          </div>

          <!-- Furnace Oil Subdivisions (Popup Outside Legend) -->
          <div id="furnaceOilSubdivisions" style="display: none; position: fixed; background: var(--light-green); color: var(--dark-green); border-radius: 1.6rem; padding: 1.2rem; box-shadow: var(--shadow); z-index: 10000; min-width: 180px;">
            <div style="font-weight: 600; margin-bottom: 0.8rem; font-size: 1.1rem; border-bottom: 1px solid var(--dark-green); padding-bottom: 0.5rem;">Types</div>
            <label class="custom-checkbox" style="display: flex; align-items: center; margin-bottom: 0.6rem; cursor: pointer;">
              <input id="toggleBiofuel" type="checkbox" checked />
              <span class="checkmark"></span>
              <span style="margin-left: 0.5rem; font-size: var(--body01);">Biofuel</span>
            </label>
            <label class="custom-checkbox" style="display: flex; align-items: center; margin-bottom: 0.6rem; cursor: pointer;">
              <input id="toggleNaturalGas" type="checkbox" checked />
              <span class="checkmark"></span>
              <span style="margin-left: 0.5rem; font-size: var(--body01);">Natural Gas</span>
            </label>
            <label class="custom-checkbox" style="display: flex; align-items: center; cursor: pointer;">
              <input id="toggleOil" type="checkbox" checked />
              <span class="checkmark"></span>
              <span style="margin-left: 0.5rem; font-size: var(--body01);">Oil</span>
            </label>
          </div>

          <div class="legend-group">
            <div class="legend-group-title">
              Manufacturing or secondary energy generation
            </div>
            <!-- Group 2: Manufacturing or secondary energy generation -->

            <!-- Steel  -->
            <div class="legend-section" id="legend-steel" draggable="true">
              <label class="custom-checkbox">
                <input id="toggleSteel" type="checkbox" checked />
                <span class="checkmark"></span>
              </label>
              <div class="legend-name">
                <div
                  class="legend-key"
                  style="
                    width: 2rem;
                    height: 2rem;
                    background-color: hsla(53, 91%, 77%, 0.5);
                    border: 0.1rem solid hsla(53, 91%, 77%, 1);
                  "
                ></div>
                <p>Steel</p>
              </div>
            </div>

            <!-- Paper Pulp -->
            <div class="legend-section" id="legend-paper-pulp" draggable="true">
              <label class="custom-checkbox">
                <input id="togglePaperPulp" type="checkbox" checked />
                <span class="checkmark"></span>
              </label>
              <div class="legend-name">
                <div
                  class="legend-key"
                  style="
                    width: 2rem;
                    height: 2rem;
                    background-color: hsla(356, 100%, 80%, 0.5);
                    border: 0.1rem solid hsla(356, 100%, 80%, 1);
                  "
                ></div>
                <p>Paper Pulp</p>
              </div>
            </div>

            <!-- Cement -->
            <div class="legend-section" id="legend-cement" draggable="true">
              <label class="custom-checkbox">
                <input id="toggleCement" type="checkbox" checked />
                <span class="checkmark"></span>
              </label>
              <div class="legend-name">
                <div
                  class="legend-key"
                  style="
                    width: 2rem;
                    height: 2rem;
                    background-color: hsla(26, 91%, 50%, 0.5);
                    border: 0.1rem solid hsla(26, 91%, 50%, 1);
                  "
                ></div>
                <p>Cement</p>
              </div>
            </div>

            <!-- Boilers -->
            <div class="legend-section" id="legend-boilers" draggable="true">
              <label class="custom-checkbox">
                <input id="toggleBoilers" type="checkbox" checked />
                <span class="checkmark"></span>
              </label>
              <div class="legend-name">
                <div
                  class="legend-key"
                  style="
                    width: 2rem;
                    height: 2rem;
                    background-color: hsla(356, 100%, 60%, 0.5);
                    border: 0.1rem solid hsla(356, 100%, 60%, 1);
                  "
                ></div>
                <p>Boilers</p>
              </div>
            </div>

            <!-- Brick Kilns -->
            <div class="legend-section" id="legend-brickKiln" draggable="true">
              <label class="custom-checkbox">
                <input id="toggleBrickKilns" type="checkbox" />
                <span class="checkmark"></span>
              </label>
              <div class="legend-name">
                <div
                  class="legend-key"
                  style="
                    width: 0.75rem;
                    height: 0.75rem;
                    background-color: hsla(356, 100%, 60%, 1);
                    margin-left: 0.5rem;
                  "
                ></div>
                <p>Brick Kilns</p>
              </div>
            </div>
          </div>

          <div class="legend-group">
            <div class="legend-group-title">Waste management</div>
            <!-- Group 3: Tertiary or waste management -->

            <!-- Land Fill Waste -->
            <div
              class="legend-section"
              id="legend-land-fill-waste"
              draggable="true"
            >
              <label class="custom-checkbox">
                <input id="toggleLandFillWaste" type="checkbox" checked />
                <span class="checkmark"></span>
              </label>
              <div class="legend-name">
                <div
                  class="legend-key"
                  style="
                    width: 2rem;
                    height: 2rem;
                    border: 0.15rem solid hsla(53, 91%, 50%, 1);
                  "
                ></div>
                <p>Land Fill Waste</p>
              </div>
            </div>

            <!-- GPW -->
            <div class="legend-section" id="legend-gpw" draggable="true">
              <label class="custom-checkbox">
                <input id="toggleGPW" type="checkbox" checked />
                <span class="checkmark"></span>
              </label>
              <div class="legend-name">
                <div
                  class="legend-key"
                  style="
                    width: 2rem;
                    height: 2rem;
                    border: 0.15rem solid hsla(205, 50%, 50%, 1);
                  "
                ></div>
                <p>GPW</p>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!--------------------------------------------------------- Brick Kiln ADM3 Filter Panel  ----------------------------------------------------->

      <div id="adm3FilterPanel" class="adm3-filter-panel">
        <h3 class="adm3-filter-title">üéØ Brick Kiln ADM3 Filter</h3>

        <label><strong>Country:</strong></label>
        <select id="adm3CountryFilter" class="adm3-select"></select>

        <label><strong>District:</strong></label>
        <select id="adm3DistrictFilter" class="adm3-select"></select>
      </div>

      <!--------------------------------------------------------- Pollutant Legend (Bottom Right) ----------------------------------------------------->
      <div id="pollutant-legend" class="pollutant-legend" style="display: none">
        <button class="closeButton">&times;</button>
        <div class="legend-title"></div>
        <div class="graduated-circles">
          <!-- Circle elements will be added here dynamically -->
        </div>
      </div>
    </div>

    <!---------------------------------------------------------------- Scrpit JS------------------------------------------------------------------->
    <script type="module" src="src/js/main.js"></script>
    <script type="module" src="src/js/layers.js"></script>
    <script type="module" src="src/js/geocoder.js"></script>
    <script type="module" src="src/js/heatmapControls.js"></script>
    <script type="module" src="src/js/topbar.js"></script>
  </body>
</html>
